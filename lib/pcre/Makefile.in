# $Id$

CC		= @CC@
AR		= @AR@
RM		= @RM@
SED		= @SED@
SEDOBJ		= @SEDOBJ@
STDOUT		= @STDOUT@
CFLAGS		= @IRC_CFLAGS@
MKDEP		= @MKDEP@
MV		= @MV@
LD		= @LD@

IRCDLIBS        = @LIBS@ $(SSL_LIBS)

INCLUDES	= -I.
CPPFLAGS	= ${INCLUDES} @CPPFLAGS@
datarootdir	= $(DESTDIR)@datarootdir@

PCRE_SRCS = \
  pcre_chartables.c  \
  pcre_compile.c     \
  pcre_exec.c        \
  pcre_globals.c     \
  pcre_study.c       \
  pcre_tables.c      \
  pcre_fullinfo.c    \
  pcre_try_flipped.c

PCRE_OBJS = ${PCRE_SRCS:.c=.o}

default: build
build: all
all: .depend libpcre.a

libpcre.a: $(PCRE_OBJS)
	$(RM) -f $@
	$(AR) csrv $@ $(PCRE_OBJS) 

.c.o:
	${CC} ${CPPFLAGS} ${CFLAGS} -c $< -o $@

.depend:
	${MKDEP} ${CPPFLAGS} ${PCRE_SRCS} ${STDOUT}
	@${SED} -e '/^# Autogenerated - do not delete/,$$d' <Makefile >Makefile.depend
	@echo "# Autogenerated - do not delete" >>Makefile.depend
	@echo "include .depend" >> Makefile.depend
	@${MV} Makefile.depend Makefile

clean:
	${RM} -f $(PCRE_OBJS) libpcre.a

distclean: clean
	${RM} -f Makefile .depend

install:
	
.PHONY: clean distclean install build
